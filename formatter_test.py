from json import dumps
from kafka import KafkaProducer

producer = KafkaProducer(
    bootstrap_servers="192.168.100.29:19092",
    value_serializer=lambda v: dumps(v).encode('utf-8'),
    key_serializer=lambda v: dumps(v).encode('utf-8')
)

producer.send(topic="netflow_formatted", value={
    "Flow ID": "TEST_FLOW_ID BARU yaaa",
    "Src IP": "192.168.100.1",
    "Src Port": 59365,
    "Dst IP": "239.255.255.250",
    "Dst Port": 0,
    "Protocol": 17,
    "Timestamp": "1615613195241.000000",
    "Flow Duration": 64956814,
    "Total Fwd Packet": 8,
    "Total Bwd packets": 0,
    "Total Length of Fwd Packet": 1060,
    "Total Length of Bwd Packet": 0,
    "Fwd Packet Length Max": 133,
    "Fwd Packet Length Min": 132,
    "Fwd Packet Length Mean": 132.5,
    "Fwd Packet Length Std": 0.5345224838248444,
    "Bwd Packet Length Max": 0,
    "Bwd Packet Length Min": 0,
    "Bwd Packet Length Mean": 0,
    "Bwd Packet Length Std": 0,
    "Flow Bytes/s": 16.318534341909075,
    "Flow Packets/s": 0.12315874975025716,
    "Flow IAT Mean": 9279544.857142856,
    "Flow IAT Std": 22953773.607598826,
    "Flow IAT Max": 61321911,
    "Flow IAT Min": 254648,
    "Fwd IAT Total": 64956814,
    "Fwd IAT Mean": 9279544.857142856,
    "Fwd IAT Std": 22953773.607598826,
    "Fwd IAT Max": 61321911,
    "Fwd IAT Min": 254648,
    "Bwd IAT Total": 0,
    "Bwd IAT Mean": 0,
    "Bwd IAT Std": 0,
    "Bwd IAT Max": 0,
    "Bwd IAT Min": 0,
    "Fwd PSH Flags": 0,
    "Bwd PSH Flags": 0,
    "Fwd URG Flags": 0,
    "Bwd URG Flags": 0,
    "Fwd Header Length": 64,
    "Bwd Header Length": 0,
    "Fwd Packets/s": 0.12315874975025716,
    "Bwd Packets/s": 0,
    "Packet Length Min": 132,
    "Packet Length Max": 133,
    "Packet Length Mean": 132.44444444444446,
    "Packet Length Std": 0.5270462766947243,
    "Packet Length Variance": 0.5270462766947243,
    "FIN Flag Count": 0,
    "SYN Flag Count": 0,
    "RST Flag Count": 0,
    "PSH Flag Count": 0,
    "ACK Flag Count": 0,
    "URG Flag Count": 0,
    "CWR Flag Count": 0,
    "ECE Flag Count": 0,
    "Down/Up Ratio": 0,
    "Average Packet Size": 149,
    "Fwd Segment Size Avg": 132.5,
    "Bwd Segment Size Avg": 0,
    "Fwd Bytes/Bulk Avg": 0,
    "Fwd Packet/Bulk Avg": 0,
    "Fwd Bulk Rate Avg": 0,
    "Bwd Bytes/Bulk Avg": 0,
    "Bwd Packet/Bulk Avg": 0,
    "Bwd Bulk Rate Avg": 0,
    "Subflow Fwd Packets": 1,
    "Subflow Fwd Bytes": 132,
    "Subflow Bwd Packets": 0,
    "Subflow Bwd Bytes": 0,
    "FWD Init Win Bytes": 0,
    "Bwd Init Win Bytes": 0,
    "Fwd Act Data Pkts": 7,
    "Fwd Seg Size Min": 8,
    "Active Mean": 1815395,
    "Active Std": 0,
    "Active Max": 1815395,
    "Active Min": 1815395,
    "Idle Mean": 807806628281468.5,
    "Idle Std": 1142411002768256,
    "Idle Max": 1615613195241026,
    "Idle Min": 61321911,
    "Label": "Label"
})

producer.flush()